---
author: lsty
title: 关于反图的一些思考
type: Thought
tags: 图论, Trick, Educational
---
# 反图
之前写的反图总结不知道存到哪里了, 这里重新写一下图论中反图的应用
我暂且把反图在图论中的作用归结于一下两点
1. 地位对调
2. 后效性消除

## 地位对调
考虑原图上的两个点 $u$, $v$, 如果 $u\rightarrow v$ 存在一个关系, 那么反图上这个关系会被对调, 关系变为 $v\rightarrow u$ 的
特别的, 考虑固定一个端点 $v$, 那么所有 $u\rightarrow v$ 的关系会变为 $v\rightarrow u$ 的关系, 也就是多对一转化为了一对多, 收束变为了发出, 而因为==在有向图中, 存在路径(存在关系)这一属性具有传递性, 可以利用前面算过的来计算后面部分的答案, 所以一对多的情况是容易计算的==
例子:
[例题1](https://www.luogu.com.cn/problem/P3916)
考虑每一个点跟答案之间的关系, 可以发现对于每一个最大值都有若干个点通过路径指向了它, 可以认为这是一组多对一的关系, 从而通过建反图, 可以枚举答案找可以到达哪一个点
[例题2](https://www.luogu.com.cn/problem/P1629)
这题要求所有点到源点的最短路, 同样的, 通过反图置换, 原本的汇点 $s$ 就变成了前往所有点的起点

## 后效性消除
通过建反图可以把一些图上问题递推问题中的后效性消除, 这就类似于反着DP(本质相同)
本质上相当于与其在递推中考虑一些"未来"过程中和现在相关的约束条件, 不如先考虑满足约束条件之后可以找到怎么样的最优结果(暂定)
需要满足这个问题逆着做的相反正好是正着做(暂定)
[例题](https://www.luogu.com.cn/problem/P3243)
正着做因为后效性的原因(每步只能考虑当前字典序最小, 不一定能尽量让编号小的靠前)不能做, 反着考虑限制: 倒着放, 每步都尽量放最大的, 那么最小的就最靠前了, 建反图拓扑排序取最大即可