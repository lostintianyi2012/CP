# ABC295 E

给你一个长度为 $N$ 的序列 $A$ 满足 $\forall i\in [1,N],A_i\in[0,M]$，其中 $M$ 是一个给定的常数

执行以下两种操作

1. 不断把序列中的一个 $0$ 换成在 $[1, M]$ 中均匀随机的一个数，直到序列中没有 $0$
2. 对整个序列升序排序

求序列第 $K$ 个数的期望值，对 $998244353$ 取模



考虑从权值的角度去做

假设 $X$ 可以在 $[1, M]$ 内取值，为 $i$ 的概率是 $p_i$， 则 $X$ 的期望值是：
$$
E(X)=\sum_{i=1}^M i \times p_i
$$
发现 $p_M$ 被加了 $M$ 次， $p_{M-1}$ 被加了 $M-1$ 次，$p_{M-2}$ 被加了 $M-2$ 次……

一个类似后缀和之和的东西，可以写成
$$
E(X)=\sum_{i=1}^{M}\sum_{j=i}^{M} p_j
$$
的形式

所以也就是
$$
E(X)=\sum_{i=1}^{M}P(X\ge i)
$$
考虑枚举权值 $X$，那就只用算出对于每个 $X$ 有 $A_k\ge X$ 的概率即可
这相当于在操作 $1$ 之后至少有 $N+1-K$ 个 $j$ 令 $A_j\ge X$
那二项式分布即可，减去原序列非 $0$ 已经 $\ge X$ 的个数，剩下的记为 $p$，再算出随机的数中至少有 $p$ 个 $\ge X$ 的概率