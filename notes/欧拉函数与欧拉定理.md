---
author: lsty
title: 欧拉函数与欧拉定理
type: Algorithm
tags: 数论
---
# 欧拉函数
设 $n$ 是一个正整数, 则欧拉函数 $\varphi(n)$ 定义为小于等于 $n$ 且与 $n$ 互素的正整数的个数
即:
$$
\varphi(n)=\sum_{i=1}^{n}[\gcd(i,n)=1]
$$
在这里我们先讨论如何求欧拉函数, 再讨论欧拉函数的作用

## 欧拉函数的求法
用==容斥原理==, 首先在 $n$ 个数中减去是 $p_1,p_2,\cdots ,p_k$ 的倍数的, 补上是 $p_1p_2,p_1p_3,\cdots p_{k-1}p_k$ 倍数的(同时是两个质因数的倍数), 再减去同时是三个质因数的倍数的$\cdots$
也就是
$$
\varphi(n)=\sum_{S\subseteq\{p_1,p_2,p_3\cdots p_k\}} (-1)^{|S|}\dfrac{n}{\prod_{p_i\in S}p_i}
$$
这个式子可以被转换为
$$
\varphi(n)=n\prod_{i=1}^k (1-\dfrac{1}{p_i})
$$
用类似考虑二项式定理的方式就可以发现这两个式子是相等的(对于每个 $i$ 要么选择 $1$ 要么选择 $-p_i$ 就可以得到展开式)
所以求单个欧拉函数的值就可以利用**试除法**或者**Pollard's rho**来求出唯一分解式然后用上面的式子计算, 这里不谈, 接下来给出求 $1\sim n$ 内所有欧拉函数值的方法

**定理1:** 欧拉函数是积性函数
也就是说
$$
若\gcd(p,q)=1,则\varphi (p)\varphi (q) = \varphi(pq)
$$
这个定理从欧拉函数的计算公式就可以得出, 根据这个定理有推论如下:
若 $n=p_1^{a_1}p_2^{a_2}p_3^{a_3}\cdots p_k^{a_k}$, 其中 $p_1,p_2,p_3,\cdots p_k$ 两两互素
则 $\varphi(n)=\varphi(p_1^{a_1})\varphi(p_2^{a_2})\varphi(p_3^{a_3})\cdots \varphi(p_k^{a_k})$
因为若 $p_1,p_2,p_3,\cdots p_k$ 两两互素, 则 $p_1^{a_1}p_2^{a_2}p_3^{a_3}\cdots p_k^{a_k}$ 两两互素

根据这个结论, 基于[[欧拉筛]]求素数, 可以提出一个 $O(n)$ 求欧拉函数的方法

```cpp
void phi_table(){
    phi[1] = 1;
    for(int i = 2; i <= n; i++){
        if(!st[i]){
            prime[++idx] = i;
            //i是素数
            phi[i] = i - 1;
        }

        for(int j = 1; prime[j] * i <= n && j <= idx; j++){
            st[prime[j] * i] = true;
            if (i % prime[j] == 0){
                //不互素, 但prime[j]是i的最小质因子
                //后面乘积的结果没有变, 但是n从i变成了*prime[j]
                phi[prime[j] * i] = phi[i] * prime[j]; 
                break;
            }
            //i与prime[j]互素
            phi[prime[j] * i] = phi[i] * phi[prime[j]];
        }
    }
}
```

## 欧拉函数的重要性质
**性质1**
$$
\sum_{i=1}^{n}\sum_{j=1}^{n}[\gcd(i,j)=k]=2\sum_{i=1}^{\lfloor\frac{n}{k}\rfloor}\varphi(i)-1
$$
也就是在 $1\le x,y \le n$ 的情况下, $\gcd(x,y)=k$ 的数对有 $2\sum_{i=1}^{\lfloor\frac{n}{k}\rfloor}\varphi(i)-1$ 对
直接考虑对 $\gcd$ 的结果求和往往是困难的, 有时候可以利用这条性质计算每种 $\gcd$ 对答案的贡献

**性质2**
$$
n=\sum_{d|n}\varphi(d)
$$

**这两条特殊性质可以用来进行欧拉反演**
# 欧拉定理
$$
若 \gcd(a,m)=1, 则 a^{\varphi(m)}\equiv 1\pmod m
$$
**证明:**
构造一个模 $m$ 意义下的简化剩余系 $r_1,r_2,\cdots r_{\varphi(m)}$ 由于 $\gcd(a,m)=1$ 所以 $ar_1,a_2,\cdots , ar_{\varphi(m)}$ 也是一个模 $m$ 下的简单剩余系, 所以有
$$
\prod_{i=1}^{\varphi(m)}r_i
\equiv
a^{\varphi(m)}\prod_{i=1}^{\varphi(m)}r_i
\pmod m
$$
同时约去 $\prod_{i=1}^{\varphi(m)}r_i$ 则
$$
a^{\varphi(m)}\equiv 1\pmod m
$$
**费马小定理**
如果令 $m$ 为素数, 则有欧拉定理的特殊形式:费马小定理
$$
a^{p-1}\equiv 1 \pmod p
$$
因为 $p$ 为质数, 显然 $\gcd(a,p)=1$