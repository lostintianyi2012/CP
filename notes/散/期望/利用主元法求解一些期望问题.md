---
tags: Mathematical_expectation, Gauss
---
在考虑一些期望问题的时候，得到的状态转移方程是由未来转移到现在的，或者直接由未知项转移而来（利用全期望公式），虽然无法递推求解，但由于期望的线性性质，通常考虑利用高斯消元解线性方程组求得期望
但高斯消元的复杂度是 $O(n^3)$ 所以在实际使用过程中通常利用未知项在矩阵中的规律分布（例如带状矩阵）来手动高斯消元求解线性方程组，达到优化复杂度的目的
在转移方程成环时，还有一种优化复杂度的更为泛用的方法——主元法
主元法是指，在转移方程中，可以设若干个项作为主元，通过主元来表示出其他未知项，由于成环的转移方程，最终关于==主元会得到多条方程==，通过对主元的方程进行求解，可以反推出转移过程中的所有项。

## 例子1
给出 $n$ 个点，每次从中均匀随机取一个点，求出现连续 $m$ 次选中同一个点的期望步数
不妨设 $f_i$ 表示已经连续取了 $i$ 个点时的还需要的期望步数
那么显然 $f_m=0$，答案为 $f_1+1$
已经连续取了 $i$ 个点时有两种情况：
1. 下一步取了其他的点，概率为 $\dfrac{n-1}{n}$
2. 下一步还是取同一个点，概率为 $\dfrac{1}{n}$
所以有
$$
f_i=\dfrac{n-1}{n}(f_0+1)+\dfrac{1}{n}(f_{i+1}+1)
$$
考虑利用主元法：不妨设 $f_0=x$
那么
$$
f_{m-1}=\dfrac{n-1}{n}x+1
$$
从而有
$$
\begin{equation}
\begin{aligned}
f_{m-2}&=\dfrac{n-1}{n}x+\dfrac{1}{n}(\dfrac{n-1}{n}x+1)\\
&=\dfrac{n^2-1}{n^2}x+\dfrac{1}{n}
\end{aligned}
\end{equation}
$$
可以一直递推到 $f_0$
则关于 $f_0$ 就有两条等式，可以解出 $f_0$
从而求得每一步的期望

## 例子2