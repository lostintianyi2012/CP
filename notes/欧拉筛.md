---
author: lsty
title: 欧拉筛
type: Algorithm
tags: 数论, 筛法
---
# 欧拉筛
欧拉筛是一种线性筛素数的方法, 原理是保证每个合数只被他的最小质因子筛去
```cpp
//st[i]为true表示这个数是合数
//prime[i]表示第 i 个素数
void prime_table(){
    for(int i = 2; i <= n; i++){
        if(!st[i])
            prime[++idx] = i;

        for(int j = 1; prime[j] * i <= n && j <= idx; j++){
            st[prime[j] * i] = true;
            if (i % prime[j] == 0)
                break;
        }
    }
}
```
在后面的 for 循环中有两种情况:
1. $i \mod prime[j]\neq 0$ , 由于我们从大到小枚举质因子并且一旦能整除就退出, 这说明 $prime[j]$ 和之前没有任何一个素数可以整除 $i$, 此时 $prime[j]$ 比 $i$ 的最小质因子还小, 是 $i\times prime[j]$ 的最小质因子
2. $i \mod prime[j]=0$, $prime[j]$ 是第一个能整除 $i$ 的质因子, 所以是 $i$ 的最小质因子, 从而 $i\times prime[j]$ 的乘积最小质因子也是 $prime[j]$

所以, 每个数只会被他的最小质因子筛去, 时间复杂度 $O(n)$

### 应用
除了线性筛素数以外欧拉筛稍加改造就可以同时线性筛积性函数函数值, 比如 [[欧拉函数与欧拉定理.md#欧拉函数的求法]]