---
author: lsty
title: 双联通分量
type: Algorithm
tags: 图论
---
# 双联通分量
双联通分量在图论上有着特殊的性质, 可以把双联通分量中的所有点看作是地位相等的, 把整个分量一起考虑, 称之为缩点
## 相关定义
联通分量: 图上的一个连通块被称为一个连通分量
割点: 如果删去图上的一个点 $u$ 和与其相连的所有边, 图的连通分量增多, 称点 $u$ 为图的一个割点
割边: 如果删掉图上的一条边 $e$, 图的连通分量增多, 称 $e$ 为图的一条割边(或者桥)
点双联通分量: 原图中任意一个没有割点的极大连通子图称为原图的一个点双联通分量
边双联通分量: 原图中任意一个没有割边的极大连通子图称为原图的一个边双联通分量
DFS生成树: 从图上的一个点开始进行DFS, 所得到的生成树, 在树上的边记为树边, 不在树上的边记为非树边

## 求法
先考虑求点双联通分量的方法, 求边双联通分量的方法是类似的
首先有一个朴素而直接的想法: 枚举每一个点, 暴力删除这个点, DFS求联通分量
时间复杂度是 $O(n(n+m))$ 的
模拟一下从一个点开始出发进行DFS的过程, 把DFS经过的边和点标注出来, 可以发现:
如果经过一条边, 记当前点为 $u$, 边为 $(u,v)$, 发现这条边连到的点 $v$ 已经被标注过了且在DFS生成树上 $v$ 是 $u$ 的祖先, 那么 $u\rightsquigarrow v$ 的这条路径上的所有点属于同一个点双联通分量, 
反之, 如果有一个点 $u$ 存在一个子节点 $v$, 其子树内的所有节点都没有与 $u$ 的祖先相连的, 那么 $u$ 就是一个割点
特殊的, 如果根节点有两个或以上的子节点, 那么根节点是一个割点
有了上面的结论就可以容易判断一个点是否是割点, 对于每个点 $u$ 维护 $low[u]$ 表示 $u$ 及其子树最远能到的祖先节点的时间戳, $dfn[u]$ 表示点 $u$ 的访问顺序
如果一个节点 $u$ 和其子节点 $v$ 有 $low[v]\ge dfn[u]$, 说明 $v$ 最多回退到 $u$ 的位置(因为无向边), 不与 $u$ 的祖先相连, 则 $u$ 是一个割点
一个割点必然是至少两个点双联通分量的公共点, 每找到一个割点, 就访问完了一个点双联通分量(深度更深的), 所以在DFS的过程中可以把==边==存到一个栈里面, 每次访问到一个割点, 就把栈里面的内容全部拿出来, 这些==边==都属于同一个双联通分量(存的是边的原因是边只能属于一个分量, 而点可以属于多个, 把点放入栈中会导致点最后只属于最后找到的那个双联通分量)

求边双连通分量的过程就与求点双联通分量的过程大同小异, 只是把 $low[v]\ge dfn[u]$ 改成 $low[v] > dfn[u]$, 这说明 $v$ 的子树内最多回到 $v$ 而不能回到 $u$, 则 $(u,v)$ 是一条割边, 同样的, 放入栈中的应该是一个点