---
aliases: 乘法逆元
tags: 数论
date: 2023-2-24
---
## 定义
给定整数 $a$ 满足 $\gcd(a,m)=1$, 则称满足 $ax\equiv 1\pmod m$ 的一个解为 $a\mod m$ 的一个逆元, 记作 $a^{-1}$
容易发现在 $\bmod\ m$ 意义下, 一个数除 $a$ 等价于乘上 $a^{-1}$
当且仅当 $a\perp m$ 是 $a$ 有乘法逆元
## 求法
**求单个逆元**
1. **[[扩展欧几里得]]求逆元**
不妨把 $ax\equiv 1\pmod m$ 看作 $ax+my\equiv 1$, 从而可以求出 $x$ 的解
2. [[欧拉函数与欧拉定理#欧拉定理]]求逆元(费马小定理求逆元)
通常用于 $m$ 为素数的场景, 此时有 $a^{m-1}\equiv 1\pmod m$, $a^{m-2}$ 即为 $a$ 的逆元

**求$1\sim n$ 内的所有逆元**
==假设 $p$ 为质数==, 则有:
若令 $\lfloor \frac{p}{i}\rfloor=k$, $p\bmod i=r$, 则 $ik+r\equiv 0\pmod p$
两边同乘 $r^{-1}i^{-1}$ 得到 $r^{-1}k+i^{-1}\equiv 0\pmod p$
移项即有 $i^{-1}\equiv -kr^{-1}\pmod p$
重新展开就有 $i^{-1}\equiv -\lfloor \frac{p}{i}\rfloor r^{-1}\pmod p$
后式显然是个负数, 可以两边同加 $pr^{-1}$ 变成正数
$$
i^{-1}\equiv (p-\lfloor \frac{p}{i}\rfloor) r^{-1}\pmod p
$$
$1$ 的逆元是 $1$ 所以可以线性递推