---
author: lsty
title: 扩展欧几里得
type: Algorithm
tags: 数论, 基础
---
**接下来讨论的一切方程, 其中所有数没有特殊说明默认只能取整数**
# 扩展欧几里得
扩展欧几里得可以求方程
$$
ax+by=\gcd(a,b)
$$
的一组可行解
## 过程
设
$$
ax_1+by_1=\gcd(a, b)
$$
再设
$$
bx_2+(a\bmod b)y_2=\gcd(b, a\bmod b)
$$
所以有
$$
ax_1+by_1=bx_2+(a\bmod b)y_2
$$
把 $a\bmod b$ 写成 $a-(\lfloor\frac{a}{b}\rfloor\times b)$
即有
$$
ax_1+by_1=bx_2+(a-(\lfloor\frac{a}{b}\rfloor\times b))y_2 \\
ax_1+by_1=ay_2+b(x_2-\lfloor\frac{a}{b}\rfloor y_2)
$$
所以
$$
x_1=y_2,y_1=x_2-\lfloor\frac{a}{b}\rfloor y_2
$$
只要不断递归计算即可, 只要算出 $x2, y2$ 就可以得到 $x1, y1$
边界情况是 $\gcd(a,b)x+by=gcd(a,b)$, 显然 $x=1$, $y=0$
所以可以给出以下代码
```cpp
void ex_gcd(ll a, ll b, ll& d, ll& x, ll& y){
    if(b == 0){ d = a, x = 1, y = 0;}
    else{
        //x1=y2, y1=x2
        ex_gcd(b, a % b, d, y, x);
        y -= a / b * x;
    }
}
```

**定理1:**
若
$$
ax+by=\gcd(a,b)
$$
的一组解为 $x=x_0$, $y=y_0$, 则若令 $d=\gcd(a,b)$ 该方程的任意一组解可以被表示为 $x=x_0+\frac{b}{d}k$, $y=y_0-\frac{a}{d}k$, 其中 $k\in \rm Z$
**证明:**
$$
ax_0+by_0=\gcd(a,b)\\
则\ a(x_0+\frac{b}{d})+b(y_0-\frac{a}{d})=ax_0+by_0+\frac{ab}{d}-\frac{ab}{d}=\gcd(a,b)
$$
如果不限制 $a, b, x, y$ 均为整数, 则 $d$ 可以取任意数, 但如果要求整数, $d$ 是最小的令 $\frac{a}{d},\frac{b}{d}$ 均为整数的数

**定理2(裴蜀定理)**
方程
$$
ax+by=n
$$
有解当且仅当 $gcd(a,b)|n$
对于这样的方程, 首先求出
$$
ax+by=gcd(a,b)
$$
的解, 然后给 $x, y$ 同乘 $\dfrac{n}{\gcd(a,b)}$
其通解公式不变, 仍为 $x=x_0+\frac{b}{d}k$, $y=y_0-\frac{a}{d}k$, 其中 $k\in \rm Z$